<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit {{ quiz.title }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        label { display: block; margin-top: 10px; }
        input, textarea, select {
            padding: 6px; margin: 5px 0; border: 1px solid #ccc; border-radius: 4px;
        }
        button, a {
            background: purple; color: yellow; padding: 8px 14px;
            border-radius: 5px; border: none; margin-top: 10px; cursor: pointer; text-decoration: none;
        }
        button:hover, a:hover { opacity: 0.9; }
        .question-card {
            border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 6px; background: #fff;
        }
    </style>
    <script>
        function showAnswerFields() {
            let count = document.getElementById("answer_count").value;
            let container = document.getElementById("answers_container");
            container.innerHTML = "";
            for (let i = 0; i < count; i++) {
                container.innerHTML += `
                    <div>
                        <input type="text" name="answer_${i}" placeholder="Answer ${i+1}">
                        <label>
                            <input type="checkbox" name="correct_answers" value="${i}"> Correct
                        </label>
                    </div>`;
            }
        }
    </script>
</head>
<body>
<h1>Edit Quiz: {{ quiz.title }}</h1>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <label>Title:</label>
    <input type="text" name="title" value="{{ quiz.title }}" required>

    <label>Description:</label>
    <textarea name="description">{{ quiz.description }}</textarea>

    <h2>Questions</h2>
    {% for question in questions %}
        <div class="question-card">
            <p><b>{{ question.text }}</b> {% if question.multiple_choice %}(Multiple Choice){% endif %}</p>
            <p><b>Timer:</b> {{ question.timer }}</p>
            <ul>
                {% for answer in question.answers.all %}
                    <li>
                        {{ answer.text }}
                        {% if answer.is_correct %}<strong>(Correct)</strong>{% endif %}
                    </li>
                {% endfor %}
            </ul>
            <button type="submit" name="delete_question" value="{{ question.id }}">Delete</button>
        </div>
    {% empty %}
        <p>No questions yet.</p>
    {% endfor %}

    <h2>Add New Question</h2>
    <input type="text" name="new_question" placeholder="Question text">

    <label><input type="checkbox" name="multiple_choice"> Multiple Choice</label>

    <label>Number of answers (max 5):</label>
    <input type="number" id="answer_count" name="answer_count" min="1" max="5" onchange="showAnswerFields()">

    <label>Timer (15-60):</label>
    <input type="number" id="timer" name="timer_amount" min="15" max="60">

    <div id="answers_container"></div>

    <label>Optional image:</label>
    <input type="file" name="image" accept="image/*">

    <button type="submit">Save Changes</button>
</form>
<br>
<a href="{% url 'quizzes' %}">Back to Quizzes</a>
</body>
</html>
